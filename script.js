/// @ts-check
/// <reference path=".gitpod/p5.global-mode.d.ts" />
"use strict";

/* Game opdracht
   Informatica - Emmauscollege Rotterdam
   Template voor een game in JavaScript met de p5 library

   Begin met dit template voor je game opdracht,
   voeg er je eigen code aan toe.
 */




/* ********************************************* */
/* globale variabelen die je gebruikt in je game */
/* ********************************************* */

const UITLEG = 0;
const SPELEN = 1;
const GAMEOVER = 2;
var spelStatus = SPELEN;

var spelerX = 200; // x-positie van speler
var spelerY = 100; // y-positie van speler

var kogelX = 0;    // x-positie van kogel
var kogelY = 0;    // y-positie van kogel

var vijandX = 800;   // x-positie van vijand
var vijandY = 500;   // y-positie van vijand

var score = 0; // aantal behaalde punten





/* ********************************************* */
/*      functies die je gebruikt in je game      */
/* ********************************************* */


/**
 * Tekent het speelveld
 */
var tekenVeld = function () {
  fill(164, 218, 239);
  rect(20, 20, width - 2 * 20, height - 2 * 20);
  fill("green")
  rect(20, 535, width - 2 * 20, height - 20 * 20)
  fill("gray")
  rect(150, 120, 100, 20)
  rect(400, 400, 100, 20)
  rect (800, 300, 100, 20)
};


/**
 * Tekent de vijand
 * @param {number} x x-coördinaat
 * @param {number} y y-coördinaat
 */
var tekenVijand = function(x, y) {
   strokeWeight (1);
    fill(205, 77, 77); 
   ellipse (x, y, 70, 70);
   fill("brown");
   ellipse (x - 15, y + 4, 20, 20);
   ellipse (x + 15, y + 4, 20, 20);
   strokeWeight (4);
   line (x + 23, y - 8, x + 3, y);
   line (x - 3, y, x - 23, y - 8);
};


/**
 * Tekent de kogel of de bal
 * @param {number} x x-coördinaat
 * @param {number} y y-coördinaat
 **/
var tekenKogel = function(x, y) {


};


/**
 * Tekent de speler
 * @param {number} x x-coördinaat
 * @param {number} y y-coördinaat
 */
var tekenSpeler = function(x, y) {
    var eyeSize = 13;
  strokeWeight (1)
  fill(255, 225, 199);
  ellipse(x, y - 5, 50, 50);
  fill(189, 138, 230);
  ellipse(x - 10, y - 4, eyeSize, eyeSize);
  ellipse(x + 10, y - 4, eyeSize, eyeSize);
};


/**
 * Updatet globale variabelen met positie van vijand of tegenspeler
 */
var speed = 5;
var beweegVijand = function draw() {
    vijandX = vijandX + speed;

    if (vijandX > 1220) {
        speed = -5
    } if (vijandX < 70) {
        speed = 5;
    }
};


/**
 * Updatet globale variabelen met positie van kogel of bal
 */
var beweegKogel = function() {

};


/**
 * Kijkt wat de toetsen/muis etc zijn.
 * Updatet globale variabele spelerX en spelerY
 */
var KeyA = 65;
var KeyD = 68;
var KeyW = 87;

var beweegSpeler = function draw() {
     if (keyIsDown(KeyA)) {
    spelerX = spelerX - 6;
  }
  if (keyIsDown(KeyD)) {
    spelerX = spelerX + 6;
  } if (keyIsDown(KeyW)) {
    spelerY = spelerY - 5;
  }

   if (spelerY < 515) {
       var gravitySpeed = 1;
        gravitySpeed = gravitySpeed * 1.5;
        spelerY = spelerY + gravitySpeed;
    }
};

/*var physics = function draw{
    var speedY = 0;
    var gravity = 0.1;
    var gravitySpeed = 0;
    var appliedGravity = function() {
        gravitySpeed += gravity;
        spelerY += speedY;
    }
} */


/**
 * Zoekt uit of de vijand is geraakt
 * @returns {boolean} true als vijand is geraakt
 */
var checkVijandGeraakt = function() {

  return false;
};


/**
 * Zoekt uit of de speler is geraakt
 * bijvoorbeeld door botsing met vijand
 * @returns {boolean} true als speler is geraakt
 */
var checkSpelerGeraakt = function() {
  return false;
};


/**
 * Zoekt uit of het spel is afgelopen
 * @returns {boolean} true als het spel is afgelopen
 */
var checkGameOver = function() {
  return false;
};


/**
 * setup
 * de code in deze functie wordt één keer uitgevoerd door
 * de p5 library, zodra het spel geladen is in de browser
 */
function setup() {
  // Maak een canvas (rechthoek) waarin je je speelveld kunt tekenen
  createCanvas(1280, 720);

  // Kleur de achtergrond blauw, zodat je het kunt zien
  background('blue');
}


/**
 * draw
 * de code in deze functie wordt meerdere keren per seconde
 * uitgevoerd door de p5 library, nadat de setup functie klaar is
 */
function draw() {
  switch (spelStatus) {
    case SPELEN:
      beweegVijand();
      beweegKogel();
      beweegSpeler();
      
      if (checkVijandGeraakt()) {
        // punten erbij
        // nieuwe vijand maken
      }
      
      if (checkSpelerGeraakt()) {
        // leven eraf of gezondheid verlagen
        // eventueel: nieuwe speler maken
      }

      tekenVeld();
      tekenVijand(vijandX, vijandY);
      tekenKogel(kogelX, kogelY);
      tekenSpeler(spelerX, spelerY);

      if (checkGameOver()) {
        spelStatus = GAMEOVER;
      }
      break;
  }
}
